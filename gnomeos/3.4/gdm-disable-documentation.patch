From d2e7caf3b67bc76d7354a20344505ba22f877de7 Mon Sep 17 00:00:00 2001
From: Colin Walters <walters@verbum.org>
Date: Sun, 15 Jan 2012 16:49:07 -0500
Subject: [PATCH] build: Add --disable-documentation

Documentation is the source of many cyclical build loops.  Allow
operating system builders to manually cut these cycles initially
by disabling documentation for a first pass.
---
 Makefile.am  |    8 +++++++-
 configure.ac |    4 ++++
 2 files changed, 11 insertions(+), 1 deletions(-)

diff --git a/Makefile.am b/Makefile.am
index f522f40..3f00a16 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -4,12 +4,18 @@ SUBDIRS = 			\
 	data			\
 	common 			\
 	daemon 			\
-	docs			\
 	gui 			\
 	utils 			\
 	po 			\
 	tests 			\
 	$(NULL)
+DIST_SUBDIRS =
+
+if ENABLE_DOCUMENTATION
+SUBDIRS += docs
+else
+DIST_SUBDIRS += docs
+endif
 
 # add these when help gets added back
 # omf-install
diff --git a/configure.ac b/configure.ac
index 30397c5..291627c 100644
--- a/configure.ac
+++ b/configure.ac
@@ -44,6 +44,10 @@ AC_CONFIG_MACRO_DIR([m4])
 IT_PROG_INTLTOOL([0.40.0])
 
 GNOME_DOC_INIT
+AC_ARG_ENABLE([documentation],
+	AS_HELP_STRING([--enable-documentation], [enable man pages and HTML documentation]),
+	[], [enable_documentation=yes])
+AM_CONDITIONAL(ENABLE_DOCUMENTATION, test x$enable_documentation = xyes)
 
 GETTEXT_PACKAGE=gdm
 AC_SUBST(GETTEXT_PACKAGE)
-- 
1.7.6.4

