From b37eee01220036d8899e91f334a77d2a4983f43a Mon Sep 17 00:00:00 2001
From: Colin Walters <walters@verbum.org>
Date: Fri, 20 Jan 2012 17:23:05 -0500
Subject: [PATCH] gdm: Switch to use common- auth

---
 data/gdm           |   15 ++++-----------
 data/gdm-autologin |   13 ++++---------
 data/gdm-welcome   |   12 ++++--------
 3 files changed, 12 insertions(+), 28 deletions(-)

diff --git a/data/gdm b/data/gdm
index 58c397d..44d509b 100644
--- a/data/gdm
+++ b/data/gdm
@@ -1,12 +1,5 @@
 #%PAM-1.0
-auth       required    pam_env.so
-auth       required    pam_succeed_if.so user != root quiet
-auth       sufficient  pam_succeed_if.so user ingroup nopasswdlogin
-auth       include     system-auth
-account    required    pam_nologin.so
-account    include     system-auth
-password   include     system-auth
-session    optional    pam_keyinit.so force revoke
-session    include     system-auth
-session    required    pam_loginuid.so
-session    optional    pam_console.so
+auth       include     common-auth
+account    include     common-auth
+password   include     common-auth
+session    include     common-auth
diff --git a/data/gdm-autologin b/data/gdm-autologin
index c4e598a..44d509b 100644
--- a/data/gdm-autologin
+++ b/data/gdm-autologin
@@ -1,10 +1,5 @@
 #%PAM-1.0
-auth       required    pam_env.so
-auth       required    pam_permit.so
-account    required    pam_nologin.so
-account    include     system-auth
-password   include     system-auth
-session    optional    pam_keyinit.so force revoke
-session    include     system-auth
-session    required    pam_loginuid.so
-session    optional    pam_console.so
+auth       include     common-auth
+account    include     common-auth
+password   include     common-auth
+session    include     common-auth
diff --git a/data/gdm-welcome b/data/gdm-welcome
index b301f4f..44d509b 100644
--- a/data/gdm-welcome
+++ b/data/gdm-welcome
@@ -1,9 +1,5 @@
 #%PAM-1.0
-auth       required    pam_env.so
-auth       required    pam_permit.so
-account    required    pam_nologin.so
-account    include     system-auth
-password   include     system-auth
-session    required    pam_loginuid.so
-session    optional    pam_keyinit.so force revoke
-session    include     system-auth
+auth       include     common-auth
+account    include     common-auth
+password   include     common-auth
+session    include     common-auth
-- 
1.7.6.5

